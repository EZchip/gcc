# .init/.fini section routines

crti.o: $(gcc_srcdir)/config/arc/crti.asm
	$(gcc_compile) \
	-c -x assembler-with-cpp $<

crtn.o: $(gcc_srcdir)/config/arc/crtn.asm
	$(gcc_compile) \
	-c -x assembler-with-cpp $<

crtg.o: $(gcc_srcdir)/config/arc/crtg.asm
	$(gcc_compile) \
	-c -x assembler-with-cpp $<

crtgend.o: $(gcc_srcdir)/config/arc/crtgend.asm
	$(gcc_compile) \
	-c -x assembler-with-cpp $<

mcount.o: $(gcc_srcdir)/config/arc/gmon/mcount.c
	$(gcc_compile) -isystem $(gcc_srcdir)/config/arc/gmon \
	-c $< \
	-fcall-saved-r0 -fcall-saved-r1 -fcall-saved-r2 -fcall-saved-r3 \
	-fcall-saved-r4 -fcall-saved-r5 -fcall-saved-r6 -fcall-saved-r7 \
	-fomit-frame-pointer

gmon.o: $(gcc_srcdir)/config/arc/gmon/gmon.c
	$(gcc_compile) -isystem $(gcc_srcdir)/config/arc/gmon \
	-mno-sdata -c $< \
	-Wno-extra # suppress inane warning about missing initializer.
	# Adding initializers for the remaining elements of gmonparam would
	# make the code more brittle.

prof-freq-stub.o: $(gcc_srcdir)/config/arc/gmon/prof-freq-stub.S
	$(gcc_compile) -isystem $(gcc_srcdir)/config/arc/gmon $(GCC_CFLAGS) \
	-c $<

prof-freq.o: $(gcc_srcdir)/config/arc/gmon/prof-freq.c
	$(gcc_compile) -isystem $(gcc_srcdir)/config/arc/gmon $(GCC_CFLAGS) \
	-c $<

dcache_linesz.o: $(gcc_srcdir)/config/arc/gmon/dcache_linesz.S
	$(gcc_compile) -isystem $(gcc_srcdir)/config/arc/gmon $(GCC_CFLAGS) \
	-c $<

profil.o: $(gcc_srcdir)/config/arc/gmon/profil.S
	$(gcc_compile) -isystem $(gcc_srcdir)/config/arc/gmon $(GCC_CFLAGS) \
	-c $<

profil-uclibc.o: $(gcc_srcdir)/config/arc/gmon/profil-uclibc.c
	$(gcc_compile) -isystem $(gcc_srcdir)/config/arc/gmon $(GCC_CFLAGS) \
	-c $<

libgmon.a: mcount.o gmon.o dcache_linesz.o $(PROFILE_OSDEP)
	$(AR_CREATE_FOR_TARGET) $@ $^
